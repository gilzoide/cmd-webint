{% extends "base.html" %}

{% block main_body %}
    <!-- Your texts and search input. -->
    <div class="container" style="margin-top: 20pt; margin-bottom: 20pt;">
        <div class="row">
            <div class="col-md-5 col-xs-12">
                <h1 style="display: inline;">Your texts<h1>
            </div>
            <div class="col-md-5 col-xs-12">
                <!--
                <form class="form-inline text-right" role="search">
                    <div class="form-group">
                      <input type="text" class="form-control" placeholder="Search">
                    </div>
                    <button type="submit" class="btn btn-default">Search</button>
                </form>
                -->
            </div>

            <div class="col-md-2 col-xs-12 text-right top-margin-xs">
                <button type="button" class="btn btn-success" data-toggle="modal" data-target="#submitModal">
                    <span class="glyphicon glyphicon-upload" aria-hidden="true"></span>
                    Submit text
                </button>
            </div>
        </div>
    </div>

    <!-- Submit text modal -->
    <div class="modal fade" id="submitModal" tabindex="-1" role="dialog" aria-labelledby="submitModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="submitModalLabel">Submit a text</h4>
          </div>
          <div class="modal-body">
            <form class="form-horizontal" id="submitForm" action="submit" method="POST">
                <div class="form-group">
                    <label for="submitTitle" class="col-sm-2 control-label">Title</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control submit-text-input" id="submitTitle" placeholder="Hansel and Gretel" name="title">
                    </div>
                </div>
                <div class="form-group">
                    <label for="submitAuthor" class="col-sm-2 control-label">Author</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control submit-text-input" id="submitAuthor" placeholder="Brothers Grimm" name="author">
                    </div>
                </div>
                <div class="form-group">
                    <label for="submitSource" class="col-sm-2 control-label">Source</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control submit-text-input" id="submitSource" placeholder="http://en.wikipedia.org/wiki/Hansel_and_Gretel" name="source">
                    </div>
                </div>
                <div class="form-group">
                    <label for="submitDate" class="col-sm-2 control-label">Date</label>
                    <div class="col-sm-10">
                        <input type="date" class="form-control submit-text-input" id="submitDate" placeholder="Publication date" name="publication_date">
                    </div>
                </div>
                <div class="form-group">
                    <label for="submitGenre" class="col-sm-2 control-label">Genre</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control submit-text-input" id="submitGenre" placeholder="Fairy tale" name="genre">
                    </div>
                </div>
                <div class="form-group">
                    <label for="submitContent" class="col-sm-2 control-label">Content</label>
                    <div class="col-sm-10">
                        <textarea rows="10" cols="25" class="form-control submit-text-input" id="submitContent" placeholder="Once upon a time, ..." name="content"></textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label for="submitRevisedContent" class="col-sm-2 control-label">Revised content</label>
                    <div class="col-sm-10">
                        <textarea rows="10" cols="25" class="form-control submit-text-input" id="submitRevisedContent" placeholder="Once upon a <disf>ti</disf> time, ..." name="content"></textarea>
                    </div>
                </div>
            </form>
          </div>
          <div class="modal-footer">
            <div class="row">
                <div class="col-xs-2 text-left">
                    <button type="button" class="btn btn-danger" onclick="clearSubmitForm()">Clear</button>
                </div>
                <div class="col-xs-10 text-right">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" id="submitTextButton" form="submitForm" class="btn btn-primary" disabled>Submit text</button>
                </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Text info modal -->
    <div class="modal fade" id="textInfoModal" tabindex="-1" role="dialog" aria-labelledby="textInfoModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="textInfoModalLabel">Overview</h4>
          </div>
          <div class="modal-body" id="textInfoModalBody">
            <div class="container-fluid">
                <!-- HTML loaded from server comes here. -->
            </div>
          </div>
          <div class="modal-footer">
            <div class="row">
                <div class="col-xs-10 text-right">
                    <div class="dropdown">
                        <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                            <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span>
                            Export as
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="dropdownMenu1">
                            <li role="presentation" id="exportCsvButton" class="export-button"><a role="menuitem" tabindex="-1">CSV</a></li>
                            <li role="presentation" id="exportArffButton" class="export-button"><a role="menuitem" tabindex="-1">ARFF</a></li>
                            <li role="presentation" id="exportJsonButton" class="export-button"><a role="menuitem" tabindex="-1">JSON</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-xs-2 text-right">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- User texts -->
    <!--  style="box-shadow: 0 0 3px 1px rgba(0, 0, 0, .5);" -->

    <div class="container">
        <table class="table table-striped table-hover">
            <tr>
                <th>Title</th>
                <th>Author</th>
                <th>Source</th>
                <th>Date</th>
                <th>Genre</th>
            </tr>
            {% for t in current_user.texts %}
            <tr class="text-row" data-textid="{{ t.id }}" data-toggle="modal" data-target="#textInfoModal">
                <td>{{ t.title }}</td>
                <td>{{ t.author }}</td>
                <td>{{ t.source }}</td>
                <td>{{ t.publication_date }}</td>
                <td>{{ t.genre }}</td>
            </tr>
            {% endfor %}
        </table>

        {% if current_user.texts|length == 0  %}
        <h3 class="text-center">No text submitted yet.</h3>
        {% endif %}
    </div>

{% endblock %}

{% block js_include %}
    {{ super() }}
    <script type="text/javascript" src="static/js/analyze.js"></script>
{% endblock %}